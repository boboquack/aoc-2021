s='''[[8,[[8,6],[6,0]]],[8,[[1,8],1]]]
[[[8,[7,5]],[8,8]],[1,5]]
[[[4,[4,5]],[[0,8],7]],3]
[[[8,[5,9]],8],[[6,[1,5]],7]]
[[[5,[0,8]],[0,[4,6]]],[[7,[4,7]],[[8,8],4]]]
[[5,[[4,4],5]],[3,[7,6]]]
[[2,[[4,9],[1,4]]],[4,0]]
[3,[[[4,7],6],4]]
[[[[0,5],8],4],[0,3]]
[[[1,8],[4,[3,2]]],[4,[4,[7,5]]]]
[[0,7],2]
[[[6,4],[0,4]],[[[5,7],[8,6]],2]]
[[[1,9],6],[[0,7],[3,1]]]
[[[4,2],[[1,6],4]],3]
[[[[2,9],[6,2]],6],[[[0,0],[3,5]],[[2,0],1]]]
[5,[[[0,4],[5,8]],2]]
[[[7,6],4],[[[2,5],6],2]]
[[1,6],[9,[[6,2],5]]]
[[1,[[5,6],3]],[[[6,4],[9,9]],[[3,8],1]]]
[[[[8,0],8],[[1,2],7]],[[1,1],[[5,1],[3,8]]]]
[[[8,[2,9]],[[3,0],[1,9]]],[3,9]]
[[[[9,8],[4,9]],[9,7]],1]
[[1,6],[4,5]]
[[[9,1],3],5]
[[[5,[3,2]],9],[[1,[9,3]],[[1,5],1]]]
[[8,[5,[2,1]]],[[[6,6],7],[1,[3,9]]]]
[[[[4,5],2],5],[[2,4],[2,8]]]
[[[[2,2],7],6],[4,[[8,5],[2,6]]]]
[[[[0,8],[6,4]],[[0,4],[6,5]]],[[3,[2,4]],[[3,2],7]]]
[[[8,[3,7]],[[5,3],5]],[[[9,3],[3,4]],1]]
[[2,[1,0]],[[[8,8],[4,7]],[[8,2],0]]]
[7,[8,3]]
[[[6,1],[[9,6],[3,8]]],[[[5,5],[7,1]],[[6,0],4]]]
[[[4,[1,3]],[[1,1],0]],[7,[[8,8],9]]]
[1,[[3,0],7]]
[[[[3,0],5],[[3,7],2]],[[[5,0],2],[0,[4,9]]]]
[[[[4,1],[0,1]],3],[[[2,1],[3,3]],[6,[9,2]]]]
[[[1,7],[5,9]],[[1,[7,7]],[[3,9],0]]]
[[[3,[1,0]],[[1,1],4]],[[4,3],[4,[2,0]]]]
[[[[5,1],[6,2]],[[4,9],[2,0]]],[2,[7,2]]]
[[[3,[8,6]],8],[[[9,1],[0,9]],[8,7]]]
[8,[[9,7],[[6,9],9]]]
[1,[[4,7],[5,[9,4]]]]
[[4,[[4,8],[8,8]]],[[[4,2],0],[[4,4],6]]]
[[[[1,1],[7,2]],[9,[0,7]]],[3,3]]
[[[2,[1,2]],6],[[[0,4],0],[5,[5,7]]]]
[6,[3,[4,7]]]
[[[1,4],[[1,3],[4,2]]],[6,8]]
[8,[[[6,1],1],8]]
[2,[2,[5,0]]]
[[[[6,1],[1,1]],[[4,9],[3,8]]],[[6,[6,6]],[6,2]]]
[[2,4],[1,4]]
[[[[6,0],[7,7]],[[4,1],[4,8]]],[[[6,4],8],9]]
[[1,[[0,5],3]],7]
[[[[2,9],6],[[0,9],6]],[8,7]]
[[4,6],[[[5,3],6],0]]
[4,[[3,[5,2]],[5,6]]]
[[8,[[4,8],6]],[[[9,8],5],9]]
[[[[8,7],6],[1,[3,0]]],[[5,[5,3]],6]]
[[[[5,8],9],7],[[[7,9],[0,2]],[[6,4],0]]]
[6,[[1,8],[[5,6],7]]]
[[7,[[4,8],9]],8]
[[[9,[6,4]],[1,3]],[0,7]]
[[[[1,8],[5,3]],5],[[[5,8],8],[[3,0],5]]]
[[[3,[6,7]],[2,9]],[[[7,1],1],[2,[4,1]]]]
[[8,[[9,5],[4,0]]],[[[4,3],3],[[0,8],[3,1]]]]
[[3,9],[[[6,5],[1,4]],6]]
[[2,[2,[9,0]]],[4,[0,6]]]
[[5,[8,9]],[[[9,2],4],1]]
[[5,[[8,2],[6,0]]],[9,[8,8]]]
[[[[8,8],1],[[3,4],[8,1]]],4]
[[9,[[7,2],[9,8]]],[[2,[4,9]],[[2,9],5]]]
[[[3,[9,1]],2],[0,[3,[0,3]]]]
[[9,[2,[6,2]]],[9,[9,[0,0]]]]
[[[[2,6],[2,0]],5],[[[7,9],5],[[1,5],6]]]
[[1,[[6,3],1]],[[[4,1],[0,7]],2]]
[[[[0,9],2],[[8,5],9]],[[1,[1,7]],6]]
[[[0,[8,3]],3],[[[1,9],0],[[7,2],4]]]
[[[[2,2],5],[[1,6],5]],[[[4,8],2],[[3,2],[4,8]]]]
[[[8,[6,8]],6],[0,[[3,2],7]]]
[[7,[[2,0],9]],[[4,[2,4]],[[8,8],[4,5]]]]
[[4,[[5,2],6]],[[0,7],2]]
[[4,3],[[5,[2,1]],[8,[3,3]]]]
[[[[6,1],9],4],2]
[3,[[[8,0],[3,7]],[[2,9],[6,6]]]]
[6,[[3,3],[9,[3,6]]]]
[[[9,[9,4]],3],[[1,0],0]]
[[[[1,1],[4,5]],[8,1]],[8,[2,2]]]
[[6,[0,3]],0]
[[[[3,2],8],6],[[9,[0,6]],[5,6]]]
[[4,[[4,8],[2,5]]],[[8,8],[[9,9],3]]]
[[6,7],[[8,[9,1]],[[6,3],[3,5]]]]
[2,[[3,[0,7]],[[7,4],5]]]
[[[1,4],9],[1,[[1,4],[0,1]]]]
[[[8,[9,7]],7],[[8,4],[[5,2],[5,5]]]]
[[[[9,8],[0,0]],8],[[3,[7,4]],[[0,1],[3,9]]]]
[[[[2,3],[0,0]],0],[[0,1],[[4,9],0]]]
[[8,[[5,3],2]],[[[2,9],2],[2,0]]]
[[[[2,2],[6,1]],[2,[6,6]]],[5,0]]
[[7,3],[[1,5],[[8,7],[3,1]]]]'''.split()
t=s[:]
if any(i not in '0123456789,[]' for j in s for i in j):raise Exception
s=[eval(i) for i in s]
t=[eval(i) for i in t]

def depth(n):
    if type(n)==int:return n
    a,b=n
    return 1+max(depth(a),depth(b))

def incrr(n,k):
    if type(n)==int:return n+k
    a,b=n
    return [a,incrr(b,k)]

def incrl(n,k):
    if type(n)==int:return n+k
    a,b=n
    return [incrl(a,k),b]

def expl(n,d):
    if type(n)==int:return (n,False,0,0)
    a,b=n
    if d<4:
        a,x,l,r=expl(a,d+1)
        if x:
            if r:
                b=incrl(b,r)
            return ([a,b],True,l,0)
        b,x,l,r=expl(b,d+1)
        if l:
            a=incrr(a,l)
        return ([a,b],x,0,r)
    return (0,True,a,b)

def split(n):
    if type(n)==int:
        if n>=10:
            return ([n//2,(n+1)//2],True)
        return (n,False)
    a,b=n
    a,x=split(a)
    if x:
        return ([a,b],True)
    b,x=split(b)
    return ([a,b],x)

def norm(n):
    while True:
        n,b,l,r=expl(n,0)
        if not b:
           n,b=split(n)
           if not b:
               return n

def mag(n):
    if type(n)==int:return n
    a,b=n
    return 3*mag(a)+2*mag(b)

def add(a,b):
    return norm([a,b])

while len(s)>=2:
    q=s.pop(0)
    s[0]=add(q,s[0])
print(mag(s[0]))

u=0
for i in t:
    for j in t:
        if i!=j:
            u=max(u,mag(add(i,j)))
print(u)
